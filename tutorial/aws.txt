# This is the tutorial on how to connect your first IoT device on AWS platform
Contains information about DeviceShadow, Rules for interacting with other AWS services and communication flow by using DeviceGateway and message broker that are both already implemented in the AWS

## SmartBulb tutorial
AWS IoT Core is a cloud service that connects devices with AWS services and other devices through its device gateway and message broker.

Devices can publish messages that contain a current or requested state. Devices can subscribe to messages to be notified of changes to the current and requested states of other devices. 
The AWS IoT Core device gateway receives published messages and the message broker sends them to the devices that have subscribed to them.

When a button is pressed on the control device, it publishes a new requested state message.

The AWS IoT Core device gateway in the cloud receives the published message and sends it to its message broker.

The smart lamp subscribes to these messages so the AWS IoT Core message broker send them to the smart lamp.

When the smart lamp receives a new message, it changes its state to match.

When a device is not always connected, AWS IoT Device Shadows store and communicate a device’s desired and last-reported state.

The smart lamp’s Device Shadow that stores the smart lamp’s state while either the control or the smart lamp is off line is shown in the diagram as the light bulb icon

The control device publishes the desired state to the smart lamp’s Device Shadow.

The smart lamp’s Device Shadow publishes the desired state information to the smart lamp device.

While the smart lamp is online, it receives the desired state information from the Device Shadow and updates its state to match.

After the smart lamp comes online, it queries the Device Shadow for the desired state. The smart lamp sets its state to the desired state and reports its state back to the Device Shadow.

After the control device comes online, it queries the Device Shadow for the reported state of the smart lamp. The Device Shadow sends the reported state to the control device. The device displays
 the reported state.

## Motion sensor tutorial with the rule
Upon detecting movement, the motion detector publishes a motion-detected message.

The AWS IoT rule subscribes to motion-detected messages from a motion sensor and receives the motion detector’s message.

After the rule receives a motion-detected message, its rule action publishes a new message to turn on the smart bulb.

Because the smart bulb has a Device Shadow, the update message must go to the Device Shadow instead of the smart bulb. The rule publishes a desired-state message for the Device Shadow with a desired state
 of ON.

When the Device Shadow updates it’s desired state, it publishes an updated-state message to inform subscribed clients of the change to the Device Shadow’s desired state.

The smart bulb subscribes to Device Shadow updated-state messages.

Upon receiving the updated-state message from the Device Shadow, the smart bulb sets its state to the “desired” value in the update message and turns on.

The control device also subscribes to updated-state messages from the Device Shadow to display the requested change to the smart bulb’s state.


After the smart bulb’s updates its state, it sends a reported-state message to subscribers.

The smart bulb’s Device Shadow receives the message and updates the Device Shadow to show the desired and reported states — which now match.

The control device also subscribes to reported-state messages from the device to update its display to match the devices current state.




